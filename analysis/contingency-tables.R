nms <- c("Cloud",
    "Clean water",
    "Water with sediments",
    "Non-vegetated / Stone tundra",
    "Deciduous w/ birch, willow, grass",
    "Burnt areas, mostly new",
    "Deciduous, mostly recovered w/ birch",
    "Coniferous: 40-60% damaged or pine",
    "Coniferous, mostly spruce",
    "Wetland, mostly open",
    "Dwarf shrub, shrub, lichen")

library(RColorBrewer)
coul <- colorRampPalette(brewer.pal(8, "Blues"))(25)

cm8517 <- rbind(
    c(0, 244, 0, 0, 1267, 64, 44, 78, 1035, 19, 366),
    c(5201, 4465174, 388, 7461, 20172, 9912, 105, 33054, 2040, 769, 81688),
    c(0, 220, 8476, 7321, 120, 21, 54, 112, 87, 5, 6327),
    c(5953, 17380, 5364, 232245, 526712, 44698, 38067, 84878, 108850, 29819, 795303),
    c(17324, 130928, 325, 28908, 3225386, 57331, 137872, 365409, 456456, 102662, 1306993),
    c(1652, 618, 7, 31645, 58737, 34930, 9517, 22906, 12147, 1286, 36528),
    c(3291, 1558, 55, 47874, 563129, 78159, 164607, 71701, 63434, 16770, 424763),
    c(39342, 108186, 984, 212519, 1598620, 195256, 220720, 2758052, 3009430, 306114, 798013),
    c(17290, 17679, 513, 45844, 2699817, 243896, 330618, 1128144, 4674993, 335164, 564150),
    c(22101, 24877, 106, 3039, 765474, 21941, 128895, 35663, 121325, 65409, 461871),
    c(19875, 126534, 6531, 48396, 1705056, 71092, 171671, 120384, 224084, 64887, 3009962)
)

cm8521 <- rbind(
    c(94,486,0,76,1470,105,15,154,81,9,627),
    c(16765,4429016,39,2680,49909,2692,3,28793,70,995,98300),
    c(0,200,5846,6824,434,0,7,68,31,3,9330),
    c(19706,12978,1097,158213,738244,7546,22283,112253,17878,21783,778178),
    c(74261,95898,139,42554,3457512,8733,35897,730403,123528,74035,1189090),
    c(4563,1281,7,20285,93599,10829,5386,31941,3545,3910,34841),
    c(10800,1579,68,29868,769786,1170,47978,88925,12847,13779,459139),
    c(63656,54123,524,241798,3658311,19795,66603,3093479,1073532,354279,625211),
    c(190549,31824,24,237257,5634552,12960,82227,2447248,842424,266414,320222),
    c(26338,10352,50,6150,1220677,200,15482,28985,21134,46480,275164),
    c(45351,104418,2289,44351,2338506,6688,41249,158755,66546,56398,2706008)
)

cm <- t(apply(cm8517,2,function(x) as.integer(100*x/sum(x))))[-1,-1,drop=FALSE]
