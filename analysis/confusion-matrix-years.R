nms <- c("Cloud",
    "Clean water",
    "Water with sediments",
    "Non-vegetated / Stone tundra",
    "Deciduous w/ birch, willow, grass",
    "Burnt areas, mostly new",
    "Deciduous, mostly recovered w/ birch",
    "Coniferous: 40-60% damaged or pine",
    "Coniferous, mostly spruce",
    "Wetland, mostly open",
    "Dwarf shrub, shrub, lichen")

library(RColorBrewer)
coul <- colorRampPalette(brewer.pal(8, "Blues"))(25)


doit <- function(cm, name, xlab, ylab) {
    colnames(cm) <- nms
    rownames(cm) <- nms

    cm <- cm[11:2,2:11,drop=FALSE]
    pdf(name, width=7, height=7)
    heatmap(cm, Colv = NA, Rowv = NA, col=coul, margins=c(20,20), scale="col", symm=TRUE, xlab=xlab, ylab=ylab)
    dev.off()
}

cm8517 <- rbind(
    c(0, 244, 0, 0, 1267, 64, 44, 78, 1035, 19, 366),
    c(5201, 4465174, 388, 7461, 20172, 9912, 105, 33054, 2040, 769, 81688),
    c(0, 220, 8476, 7321, 120, 21, 54, 112, 87, 5, 6327),
    c(5953, 17380, 5364, 232245, 526712, 44698, 38067, 84878, 108850, 29819, 795303),
    c(17324, 130928, 325, 28908, 3225386, 57331, 137872, 365409, 456456, 102662, 1306993),
    c(1652, 618, 7, 31645, 58737, 34930, 9517, 22906, 12147, 1286, 36528),
    c(3291, 1558, 55, 47874, 563129, 78159, 164607, 71701, 63434, 16770, 424763),
    c(39342, 108186, 984, 212519, 1598620, 195256, 220720, 2758052, 3009430, 306114, 798013),
    c(17290, 17679, 513, 45844, 2699817, 243896, 330618, 1128144, 4674993, 335164, 564150),
    c(22101, 24877, 106, 3039, 765474, 21941, 128895, 35663, 121325, 65409, 461871),
    c(19875, 126534, 6531, 48396, 1705056, 71092, 171671, 120384, 224084, 64887, 3009962)
)

cm8521 <- rbind(
    c(94,486,0,76,1470,105,15,154,81,9,627),
    c(16765,4429016,39,2680,49909,2692,3,28793,70,995,98300),
    c(0,200,5846,6824,434,0,7,68,31,3,9330),
    c(19706,12978,1097,158213,738244,7546,22283,112253,17878,21783,778178),
    c(74261,95898,139,42554,3457512,8733,35897,730403,123528,74035,1189090),
    c(4563,1281,7,20285,93599,10829,5386,31941,3545,3910,34841),
    c(10800,1579,68,29868,769786,1170,47978,88925,12847,13779,459139),
    c(63656,54123,524,241798,3658311,19795,66603,3093479,1073532,354279,625211),
    c(190549,31824,24,237257,5634552,12960,82227,2447248,842424,266414,320222),
    c(26338,10352,50,6150,1220677,200,15482,28985,21134,46480,275164),
    c(45351,104418,2289,44351,2338506,6688,41249,158755,66546,56398,2706008)
)

cm9017 <- rbind(
    c(0,20541,0,4020,129141,50889,75824,9775,20517,332,254119),
    c(1577,3722141,2928,8383,21774,3826,131,37984,5363,483,86002),
    c(22,53153,7423,4685,94,234,8,100,30,7,3355),
    c(2098,109729,3709,177575,198661,7718,10743,12261,26004,6053,406743),
    c(35717,268324,1605,54194,4602076,124451,237813,600722,1455584,193450,1349170),
    c(0,325,34,21553,22446,5528,5240,3408,9073,684,11618),
    c(1007,966,12,68520,218117,18681,30152,38133,38186,5810,186727),
    c(27826,108704,400,196982,1642582,160188,146636,2678690,3522716,272161,568397),
    c(6219,6859,95,32395,1254142,180163,187029,659229,2939507,154197,323452),
    c(19889,27655,66,13567,1099649,77146,248167,43235,357221,108551,772848),
    c(37726,586493,6479,84042,1985699,128821,260580,553154,307735,187465,3529889)
)

doit(cm8517, "confusion-matrix-1985-2017.pdf", ylab="2017", xlab="1985")
doit(cm8521, "confusion-matrix-1985-2021.pdf", ylab="2021", xlab="1985")
doit(cm9017, "confusion-matrix-1990-2017.pdf", ylab="2017", xlab="1990")

